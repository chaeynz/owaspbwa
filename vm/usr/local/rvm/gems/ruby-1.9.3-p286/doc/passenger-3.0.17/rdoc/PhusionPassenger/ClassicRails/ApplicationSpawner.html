<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>class PhusionPassenger::ClassicRails::ApplicationSpawner - passenger-3.0.17 Documentation</title>

<link type="text/css" media="screen" href="../../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../../index.html">Home</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/phusion_passenger/classic_rails/application_spawner.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link">AbstractServer
  
</nav>

    <!-- Included Modules -->
<nav id="includes-section" class="section">
  <h3 class="section-header">Included Modules</h3>

  <ul class="link-list">
  
  
    <li><a class="include" href="../Utils.html">PhusionPassenger::Utils</a>
  
  
  
    <li><a class="include" href="../DebugLogging.html">PhusionPassenger::DebugLogging</a>
  
  
  </ul>
</nav>

    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-c-new">::new</a>
    
    <li><a href="#method-c-spawn_application">::spawn_application</a>
    
    <li><a href="#method-i-spawn_application">#spawn_application</a>
    
    <li><a href="#method-i-start">#start</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    
    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../../PhusionPassenger.html">PhusionPassenger</a>
  
    <li><a href="../../PhusionPassenger/AbstractInstaller.html">PhusionPassenger::AbstractInstaller</a>
  
    <li><a href="../../PhusionPassenger/AbstractRequestHandler.html">PhusionPassenger::AbstractRequestHandler</a>
  
    <li><a href="../../PhusionPassenger/AbstractServer.html">PhusionPassenger::AbstractServer</a>
  
    <li><a href="../../PhusionPassenger/AbstractServer/InvalidPassword.html">PhusionPassenger::AbstractServer::InvalidPassword</a>
  
    <li><a href="../../PhusionPassenger/AbstractServer/ServerAlreadyStarted.html">PhusionPassenger::AbstractServer::ServerAlreadyStarted</a>
  
    <li><a href="../../PhusionPassenger/AbstractServer/ServerError.html">PhusionPassenger::AbstractServer::ServerError</a>
  
    <li><a href="../../PhusionPassenger/AbstractServer/ServerNotStarted.html">PhusionPassenger::AbstractServer::ServerNotStarted</a>
  
    <li><a href="../../PhusionPassenger/AbstractServer/UnknownMessage.html">PhusionPassenger::AbstractServer::UnknownMessage</a>
  
    <li><a href="../../PhusionPassenger/AbstractServerCollection.html">PhusionPassenger::AbstractServerCollection</a>
  
    <li><a href="../../PhusionPassenger/AdminTools.html">PhusionPassenger::AdminTools</a>
  
    <li><a href="../../PhusionPassenger/AdminTools/MemoryStats.html">PhusionPassenger::AdminTools::MemoryStats</a>
  
    <li><a href="../../PhusionPassenger/AdminTools/MemoryStats/Process.html">PhusionPassenger::AdminTools::MemoryStats::Process</a>
  
    <li><a href="../../PhusionPassenger/AdminTools/ServerInstance.html">PhusionPassenger::AdminTools::ServerInstance</a>
  
    <li><a href="../../PhusionPassenger/AdminTools/ServerInstance/CorruptedDirectoryError.html">PhusionPassenger::AdminTools::ServerInstance::CorruptedDirectoryError</a>
  
    <li><a href="../../PhusionPassenger/AdminTools/ServerInstance/GenerationsAbsentError.html">PhusionPassenger::AdminTools::ServerInstance::GenerationsAbsentError</a>
  
    <li><a href="../../PhusionPassenger/AdminTools/ServerInstance/Group.html">PhusionPassenger::AdminTools::ServerInstance::Group</a>
  
    <li><a href="../../PhusionPassenger/AdminTools/ServerInstance/Process.html">PhusionPassenger::AdminTools::ServerInstance::Process</a>
  
    <li><a href="../../PhusionPassenger/AdminTools/ServerInstance/RoleDeniedError.html">PhusionPassenger::AdminTools::ServerInstance::RoleDeniedError</a>
  
    <li><a href="../../PhusionPassenger/AdminTools/ServerInstance/StaleDirectoryError.html">PhusionPassenger::AdminTools::ServerInstance::StaleDirectoryError</a>
  
    <li><a href="../../PhusionPassenger/AdminTools/ServerInstance/Stats.html">PhusionPassenger::AdminTools::ServerInstance::Stats</a>
  
    <li><a href="../../PhusionPassenger/AdminTools/ServerInstance/UnsupportedGenerationStructureVersionError.html">PhusionPassenger::AdminTools::ServerInstance::UnsupportedGenerationStructureVersionError</a>
  
    <li><a href="../../PhusionPassenger/AnalyticsLogger.html">PhusionPassenger::AnalyticsLogger</a>
  
    <li><a href="../../PhusionPassenger/AnalyticsLogger/Connection.html">PhusionPassenger::AnalyticsLogger::Connection</a>
  
    <li><a href="../../PhusionPassenger/AnalyticsLogger/Lock.html">PhusionPassenger::AnalyticsLogger::Lock</a>
  
    <li><a href="../../PhusionPassenger/AnalyticsLogger/Log.html">PhusionPassenger::AnalyticsLogger::Log</a>
  
    <li><a href="../../PhusionPassenger/AppInitError.html">PhusionPassenger::AppInitError</a>
  
    <li><a href="../../PhusionPassenger/AppProcess.html">PhusionPassenger::AppProcess</a>
  
    <li><a href="../../PhusionPassenger/ClassicRails.html">PhusionPassenger::ClassicRails</a>
  
    <li><a href="../../PhusionPassenger/ClassicRails/ApplicationSpawner.html">PhusionPassenger::ClassicRails::ApplicationSpawner</a>
  
    <li><a href="../../PhusionPassenger/ClassicRails/ApplicationSpawner/Error.html">PhusionPassenger::ClassicRails::ApplicationSpawner::Error</a>
  
    <li><a href="../../PhusionPassenger/ClassicRails/CGIFixed.html">PhusionPassenger::ClassicRails::CGIFixed</a>
  
    <li><a href="../../PhusionPassenger/ClassicRails/FrameworkSpawner.html">PhusionPassenger::ClassicRails::FrameworkSpawner</a>
  
    <li><a href="../../PhusionPassenger/ClassicRails/FrameworkSpawner/Error.html">PhusionPassenger::ClassicRails::FrameworkSpawner::Error</a>
  
    <li><a href="../../PhusionPassenger/ClassicRails/RequestHandler.html">PhusionPassenger::ClassicRails::RequestHandler</a>
  
    <li><a href="../../PhusionPassenger/ClassicRailsExtensions.html">PhusionPassenger::ClassicRailsExtensions</a>
  
    <li><a href="../../PhusionPassenger/ClassicRailsExtensions/AnalyticsLogging.html">PhusionPassenger::ClassicRailsExtensions::AnalyticsLogging</a>
  
    <li><a href="../../PhusionPassenger/ClassicRailsExtensions/AnalyticsLogging/ACBaseExtension.html">PhusionPassenger::ClassicRailsExtensions::AnalyticsLogging::ACBaseExtension</a>
  
    <li><a href="../../PhusionPassenger/ClassicRailsExtensions/AnalyticsLogging/ACBenchmarkingExtension.html">PhusionPassenger::ClassicRailsExtensions::AnalyticsLogging::ACBenchmarkingExtension</a>
  
    <li><a href="../../PhusionPassenger/ClassicRailsExtensions/AnalyticsLogging/ACRescueExtension.html">PhusionPassenger::ClassicRailsExtensions::AnalyticsLogging::ACRescueExtension</a>
  
    <li><a href="../../PhusionPassenger/ClassicRailsExtensions/AnalyticsLogging/ARAbstractAdapterExtension.html">PhusionPassenger::ClassicRailsExtensions::AnalyticsLogging::ARAbstractAdapterExtension</a>
  
    <li><a href="../../PhusionPassenger/ClassicRailsExtensions/AnalyticsLogging/AVBenchmarkHelperExtension.html">PhusionPassenger::ClassicRailsExtensions::AnalyticsLogging::AVBenchmarkHelperExtension</a>
  
    <li><a href="../../PhusionPassenger/ClassicRailsExtensions/AnalyticsLogging/CacheStoreExtension.html">PhusionPassenger::ClassicRailsExtensions::AnalyticsLogging::CacheStoreExtension</a>
  
    <li><a href="../../PhusionPassenger/ClassicRailsExtensions/AnalyticsLogging/ConcreteCacheStoreExtension.html">PhusionPassenger::ClassicRailsExtensions::AnalyticsLogging::ConcreteCacheStoreExtension</a>
  
    <li><a href="../../PhusionPassenger/ConsoleTextTemplate.html">PhusionPassenger::ConsoleTextTemplate</a>
  
    <li><a href="../../PhusionPassenger/DebugLogging.html">PhusionPassenger::DebugLogging</a>
  
    <li><a href="../../PhusionPassenger/Dependency.html">PhusionPassenger::Dependency</a>
  
    <li><a href="../../PhusionPassenger/FrameworkInitError.html">PhusionPassenger::FrameworkInitError</a>
  
    <li><a href="../../PhusionPassenger/HTMLTemplate.html">PhusionPassenger::HTMLTemplate</a>
  
    <li><a href="../../PhusionPassenger/InitializationError.html">PhusionPassenger::InitializationError</a>
  
    <li><a href="../../PhusionPassenger/InvalidPath.html">PhusionPassenger::InvalidPath</a>
  
    <li><a href="../../PhusionPassenger/MessageChannel.html">PhusionPassenger::MessageChannel</a>
  
    <li><a href="../../PhusionPassenger/MessageChannel/InvalidHashError.html">PhusionPassenger::MessageChannel::InvalidHashError</a>
  
    <li><a href="../../PhusionPassenger/MessageClient.html">PhusionPassenger::MessageClient</a>
  
    <li><a href="../../PhusionPassenger/NativeSupportLoader.html">PhusionPassenger::NativeSupportLoader</a>
  
    <li><a href="../../PhusionPassenger/Packaging.html">PhusionPassenger::Packaging</a>
  
    <li><a href="../../PhusionPassenger/PlatformInfo.html">PhusionPassenger::PlatformInfo</a>
  
    <li><a href="../../PhusionPassenger/PlatformInfo/RuntimeError.html">PhusionPassenger::PlatformInfo::RuntimeError</a>
  
    <li><a href="../../PhusionPassenger/Plugin.html">PhusionPassenger::Plugin</a>
  
    <li><a href="../../PhusionPassenger/Rack.html">PhusionPassenger::Rack</a>
  
    <li><a href="../../PhusionPassenger/Rack/ApplicationSpawner.html">PhusionPassenger::Rack::ApplicationSpawner</a>
  
    <li><a href="../../PhusionPassenger/Rack/ApplicationSpawner/Error.html">PhusionPassenger::Rack::ApplicationSpawner::Error</a>
  
    <li><a href="../../PhusionPassenger/Rack/RequestHandler.html">PhusionPassenger::Rack::RequestHandler</a>
  
    <li><a href="../../PhusionPassenger/Rails3Extensions.html">PhusionPassenger::Rails3Extensions</a>
  
    <li><a href="../../PhusionPassenger/Rails3Extensions/AnalyticsLogging.html">PhusionPassenger::Rails3Extensions::AnalyticsLogging</a>
  
    <li><a href="../../PhusionPassenger/Rails3Extensions/AnalyticsLogging/ACExtension.html">PhusionPassenger::Rails3Extensions::AnalyticsLogging::ACExtension</a>
  
    <li><a href="../../PhusionPassenger/Rails3Extensions/AnalyticsLogging/ASBenchmarkableExtension.html">PhusionPassenger::Rails3Extensions::AnalyticsLogging::ASBenchmarkableExtension</a>
  
    <li><a href="../../PhusionPassenger/Rails3Extensions/AnalyticsLogging/ExceptionLogger.html">PhusionPassenger::Rails3Extensions::AnalyticsLogging::ExceptionLogger</a>
  
    <li><a href="../../PhusionPassenger/SpawnManager.html">PhusionPassenger::SpawnManager</a>
  
    <li><a href="../../PhusionPassenger/Standalone.html">PhusionPassenger::Standalone</a>
  
    <li><a href="../../PhusionPassenger/Standalone/AppFinder.html">PhusionPassenger::Standalone::AppFinder</a>
  
    <li><a href="../../PhusionPassenger/Standalone/Command.html">PhusionPassenger::Standalone::Command</a>
  
    <li><a href="../../PhusionPassenger/Standalone/ConfigFile.html">PhusionPassenger::Standalone::ConfigFile</a>
  
    <li><a href="../../PhusionPassenger/Standalone/ConfigFile/DisallowedContextError.html">PhusionPassenger::Standalone::ConfigFile::DisallowedContextError</a>
  
    <li><a href="../../PhusionPassenger/Standalone/HelpCommand.html">PhusionPassenger::Standalone::HelpCommand</a>
  
    <li><a href="../../PhusionPassenger/Standalone/Main.html">PhusionPassenger::Standalone::Main</a>
  
    <li><a href="../../PhusionPassenger/Standalone/PackageRuntimeCommand.html">PhusionPassenger::Standalone::PackageRuntimeCommand</a>
  
    <li><a href="../../PhusionPassenger/Standalone/RuntimeInstaller.html">PhusionPassenger::Standalone::RuntimeInstaller</a>
  
    <li><a href="../../PhusionPassenger/Standalone/StartCommand.html">PhusionPassenger::Standalone::StartCommand</a>
  
    <li><a href="../../PhusionPassenger/Standalone/StatusCommand.html">PhusionPassenger::Standalone::StatusCommand</a>
  
    <li><a href="../../PhusionPassenger/Standalone/StopCommand.html">PhusionPassenger::Standalone::StopCommand</a>
  
    <li><a href="../../PhusionPassenger/Standalone/Utils.html">PhusionPassenger::Standalone::Utils</a>
  
    <li><a href="../../PhusionPassenger/Standalone/VersionCommand.html">PhusionPassenger::Standalone::VersionCommand</a>
  
    <li><a href="../../PhusionPassenger/UnknownError.html">PhusionPassenger::UnknownError</a>
  
    <li><a href="../../PhusionPassenger/Utils.html">PhusionPassenger::Utils</a>
  
    <li><a href="../../PhusionPassenger/Utils/FileSystemWatcher.html">PhusionPassenger::Utils::FileSystemWatcher</a>
  
    <li><a href="../../PhusionPassenger/Utils/FileSystemWatcher/DirInfo.html">PhusionPassenger::Utils::FileSystemWatcher::DirInfo</a>
  
    <li><a href="../../PhusionPassenger/Utils/FileSystemWatcher/FileInfo.html">PhusionPassenger::Utils::FileSystemWatcher::FileInfo</a>
  
    <li><a href="../../PhusionPassenger/Utils/HostsFileParser.html">PhusionPassenger::Utils::HostsFileParser</a>
  
    <li><a href="../../PhusionPassenger/Utils/Kernel.html">PhusionPassenger::Utils::Kernel</a>
  
    <li><a href="../../PhusionPassenger/Utils/PseudoIO.html">PhusionPassenger::Utils::PseudoIO</a>
  
    <li><a href="../../PhusionPassenger/Utils/RewindableInput.html">PhusionPassenger::Utils::RewindableInput</a>
  
    <li><a href="../../PhusionPassenger/Utils/RewindableInput/Tempfile.html">PhusionPassenger::Utils::RewindableInput::Tempfile</a>
  
    <li><a href="../../PhusionPassenger/Utils/UnseekableSocket.html">PhusionPassenger::Utils::UnseekableSocket</a>
  
    <li><a href="../../PhusionPassenger/VersionNotFound.html">PhusionPassenger::VersionNotFound</a>
  
    <li><a href="../../PhusionPassenger/WSGI.html">PhusionPassenger::WSGI</a>
  
    <li><a href="../../PhusionPassenger/WSGI/ApplicationSpawner.html">PhusionPassenger::WSGI::ApplicationSpawner</a>
  
    <li><a href="../../ConditionVariable.html">ConditionVariable</a>
  
    <li><a href="../../Exception.html">Exception</a>
  
    <li><a href="../../GC.html">GC</a>
  
    <li><a href="../../IO.html">IO</a>
  
    <li><a href="../../Object.html">Object</a>
  
    <li><a href="../../Process.html">Process</a>
  
    <li><a href="../../Signal.html">Signal</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class PhusionPassenger::ClassicRails::ApplicationSpawner</h1>

  <div id="description" class="description">
    
<p>Spawning of Rails 1 and Rails 2 applications.</p>

<p><a href="ApplicationSpawner.html">ClassicRails::ApplicationSpawner</a> can
operate in two modes:</p>
<ul><li>
<p>Smart mode. In this mode, the Rails application’s code is first preloaded
into a temporary process, which can then further fork off application
processes. Once the code has been preloaded, forking off application
processes is very fast, and all the forked off application processes can
share code memory with each other. To use this mode, create an <a
href="ApplicationSpawner.html">ApplicationSpawner</a> object, start it, and
call <a
href="ApplicationSpawner.html#method-i-spawn_application">spawn_application</a>
on it. A single <a href="ApplicationSpawner.html">ApplicationSpawner</a>
object can only handle a single Rails application.</p>
</li><li>
<p>Conservative mode. In this mode, a Rails app process is directly spawned
without any preloading. This increases compatibility with applications. To
use this mode, call <a
href="ApplicationSpawner.html#method-c-spawn_application">::spawn_application</a>.</p>
</li></ul>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <!-- Attributes -->
    <section id="attribute-method-details" class="method-section section">
      <h3 class="section-header">Attributes</h3>

      
      <div id="attribute-i-app_root" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">app_root</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>The application root of this spawner.</p>
        
        </div>
      </div>
      
    </section><!-- attribute-method-details -->
    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(options)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>The following options are accepted:</p>
<ul><li>
<p>‘<a href="ApplicationSpawner.html#attribute-i-app_root">#app_root</a>’</p>
</li></ul>

<p>See <a
href="../SpawnManager.html#method-i-spawn_application">PhusionPassenger::SpawnManager#spawn_application</a>
for information about the options.</p>
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/phusion_passenger/classic_rails/application_spawner.rb, line 116</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">options</span>)
        <span class="ruby-keyword">super</span>()
        <span class="ruby-ivar">@options</span>          = <span class="ruby-identifier">sanitize_spawn_options</span>(<span class="ruby-identifier">options</span>)
        <span class="ruby-ivar">@app_root</span>         = <span class="ruby-ivar">@options</span>[<span class="ruby-string">&quot;app_root&quot;</span>]
        <span class="ruby-ivar">@canonicalized_app_root</span> = <span class="ruby-identifier">canonicalize_path</span>(<span class="ruby-ivar">@app_root</span>)
        <span class="ruby-keyword">self</span>.<span class="ruby-identifier">max_idle_time</span> = <span class="ruby-constant">DEFAULT_APP_SPAWNER_MAX_IDLE_TIME</span>
        <span class="ruby-identifier">define_message_handler</span>(<span class="ruby-value">:spawn_application</span>, <span class="ruby-value">:handle_spawn_application</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- new-source -->
          
        </div>

        

        
      </div><!-- new-method -->

    
      <div id="method-c-spawn_application" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">spawn_application</span><span
            class="method-args">(options)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Spawns an instance of a Rails application. When successful, an <a
href="../AppProcess.html">AppProcess</a> object will be returned, which
represents the spawned Rails application.</p>

<p>This method spawns the application directly, without preloading its code.
This method may only be called if no Rails framework has been loaded in the
current Ruby VM.</p>

<p>The “<a href="ApplicationSpawner.html#attribute-i-app_root">#app_root</a>”
option must be given. All other options are passed to the request handler’s
constructor.</p>

<p>Raises:</p>
<ul><li>
<p>AppInitError: The Ruby on Rails application raised an exception or called
exit() during startup.</p>
</li><li>
<p>SystemCallError, IOError, SocketError: Something went wrong.</p>
</li></ul>
          

          
          <div class="method-source-code" id="spawn_application-source">
            <pre><span class="ruby-comment"># File lib/phusion_passenger/classic_rails/application_spawner.rb, line 80</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">spawn_application</span>(<span class="ruby-identifier">options</span>)
        <span class="ruby-identifier">options</span> = <span class="ruby-identifier">sanitize_spawn_options</span>(<span class="ruby-identifier">options</span>)
        
        <span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span> = <span class="ruby-constant">UNIXSocket</span>.<span class="ruby-identifier">pair</span>
        <span class="ruby-identifier">pid</span> = <span class="ruby-identifier">safe_fork</span>(<span class="ruby-string">'application'</span>, <span class="ruby-keyword">true</span>) <span class="ruby-keyword">do</span>
                <span class="ruby-identifier">a</span>.<span class="ruby-identifier">close</span>
                
                <span class="ruby-identifier">file_descriptors_to_leave_open</span> = [<span class="ruby-value">0</span>, <span class="ruby-value">1</span>, <span class="ruby-value">2</span>, <span class="ruby-identifier">b</span>.<span class="ruby-identifier">fileno</span>]
                <span class="ruby-constant">NativeSupport</span>.<span class="ruby-identifier">close_all_file_descriptors</span>(<span class="ruby-identifier">file_descriptors_to_leave_open</span>)
                <span class="ruby-identifier">close_all_io_objects_for_fds</span>(<span class="ruby-identifier">file_descriptors_to_leave_open</span>)
                
                <span class="ruby-identifier">channel</span> = <span class="ruby-constant">MessageChannel</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">b</span>)
                <span class="ruby-identifier">success</span> = <span class="ruby-identifier">report_app_init_status</span>(<span class="ruby-identifier">channel</span>) <span class="ruby-keyword">do</span>
                        <span class="ruby-identifier">prepare_app_process</span>(<span class="ruby-string">'config/environment.rb'</span>, <span class="ruby-identifier">options</span>)
                        <span class="ruby-identifier">require</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-string">'config/environment'</span>)
                        <span class="ruby-identifier">require</span> <span class="ruby-string">'dispatcher'</span>
                        <span class="ruby-identifier">after_loading_app_code</span>(<span class="ruby-identifier">options</span>)
                <span class="ruby-keyword">end</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">success</span>
                        <span class="ruby-identifier">start_request_handler</span>(<span class="ruby-identifier">channel</span>, <span class="ruby-keyword">false</span>, <span class="ruby-identifier">options</span>)
                <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">b</span>.<span class="ruby-identifier">close</span>
        <span class="ruby-constant">Process</span>.<span class="ruby-identifier">waitpid</span>(<span class="ruby-identifier">pid</span>) <span class="ruby-keyword">rescue</span> <span class="ruby-keyword">nil</span>
        
        <span class="ruby-identifier">channel</span> = <span class="ruby-constant">MessageChannel</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">a</span>)
        <span class="ruby-identifier">unmarshal_and_raise_errors</span>(<span class="ruby-identifier">channel</span>, <span class="ruby-identifier">options</span>[<span class="ruby-string">&quot;print_exceptions&quot;</span>])
        
        <span class="ruby-comment"># No exception was raised, so spawning succeeded.</span>
        <span class="ruby-keyword">return</span> <span class="ruby-constant">AppProcess</span>.<span class="ruby-identifier">read_from_channel</span>(<span class="ruby-identifier">channel</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- spawn_application-source -->
          
        </div>

        

        
      </div><!-- spawn_application-method -->

    
    </section><!-- public-class-method-details -->
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-spawn_application" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">spawn_application</span><span
            class="method-args">(options = {})</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Spawns an instance of the Rails application. When successful, an <a
href="../AppProcess.html">AppProcess</a> object will be returned, which
represents the spawned Rails application.</p>

<p><code>options</code> will be passed to the request handler's constructor.</p>

<p>Raises:</p>
<ul><li>
<p>AbstractServer::ServerNotStarted: The <a
href="ApplicationSpawner.html">ApplicationSpawner</a> server hasn’t already
been started.</p>
</li><li>
<p>ApplicationSpawner::Error: The <a
href="ApplicationSpawner.html">ApplicationSpawner</a> server exited
unexpectedly.</p>
</li></ul>
          

          
          <div class="method-source-code" id="spawn_application-source">
            <pre><span class="ruby-comment"># File lib/phusion_passenger/classic_rails/application_spawner.rb, line 133</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">spawn_application</span>(<span class="ruby-identifier">options</span> = {})
        <span class="ruby-identifier">connect</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">channel</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">channel</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&quot;spawn_application&quot;</span>, *<span class="ruby-identifier">options</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">flatten</span>)
                <span class="ruby-keyword">return</span> <span class="ruby-constant">AppProcess</span>.<span class="ruby-identifier">read_from_channel</span>(<span class="ruby-identifier">channel</span>)
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">SystemCallError</span>, <span class="ruby-constant">IOError</span>, <span class="ruby-constant">SocketError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;The application spawner server exited unexpectedly: #{e}&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- spawn_application-source -->
          
        </div>

        

        
      </div><!-- spawn_application-method -->

    
      <div id="method-i-start" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">start</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Overrided from <a
href="../AbstractServer.html#method-i-start">PhusionPassenger::AbstractServer#start</a>.</p>

<p>May raise these additional exceptions:</p>
<ul><li>
<p>AppInitError: The Ruby on Rails application raised an exception or called
exit() during startup.</p>
</li><li>
<p>ApplicationSpawner::Error: The <a
href="ApplicationSpawner.html">ApplicationSpawner</a> server exited
unexpectedly.</p>
</li></ul>
          

          
          <div class="method-source-code" id="start-source">
            <pre><span class="ruby-comment"># File lib/phusion_passenger/classic_rails/application_spawner.rb, line 148</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">start</span>
        <span class="ruby-keyword">super</span>
        <span class="ruby-keyword">begin</span>
                <span class="ruby-identifier">channel</span> = <span class="ruby-constant">MessageChannel</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@owner_socket</span>)
                <span class="ruby-identifier">unmarshal_and_raise_errors</span>(<span class="ruby-identifier">channel</span>, <span class="ruby-ivar">@options</span>[<span class="ruby-string">&quot;print_exceptions&quot;</span>])
        <span class="ruby-keyword">rescue</span> <span class="ruby-constant">IOError</span>, <span class="ruby-constant">SystemCallError</span>, <span class="ruby-constant">SocketError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
                <span class="ruby-identifier">stop</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">started?</span>
                <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;The application spawner server exited unexpectedly: #{e}&quot;</span>
        <span class="ruby-keyword">rescue</span>
                <span class="ruby-identifier">stop</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">started?</span>
                <span class="ruby-identifier">raise</span>
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- start-source -->
          
        </div>

        

        
      </div><!-- start-method -->

    
    </section><!-- public-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.12.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

