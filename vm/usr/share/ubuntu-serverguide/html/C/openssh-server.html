<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head xmlns="http://www.w3.org/1999/xhtml">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title xmlns="">OpenSSH Server</title>
    <link rel="stylesheet" href="../../libs/ubuntu-book.css" type="text/css" />
    <link rel="home" href="index.html" title="Ubuntu Server Guide" />
    <link rel="up" href="remote-administration.html" title="Chapter 5. Remote Administration" />
    <link rel="prev" href="remote-administration.html" title="Chapter 5. Remote Administration" />
    <link rel="next" href="ebox.html" title="eBox" />
    <link rel="copyright" href="legal.html" title="Credits and License" />
  </head>
  <body>
    <div id="round">
      <img id="topcap" alt="" src="https://help.ubuntu.com/htdocs/ubuntunew/img/cap-top.png" />
      <div id="layout" class="container clear-block">
        <script xmlns="" src="https://ssl.google-analytics.com/urchin.js" type="text/javascript"></script>
        <script xmlns="" type="text/javascript">
_uacct = "UA-1018242-8";
urchinTracker();
</script>
        <div id="header">
          <div id="logo-floater">
            <h1>
              <a href="https://help.ubuntu.com" title="Ubuntu Documentation">
                <img alt="Ubuntu" id="logo" src="https://help.ubuntu.com/htdocs/ubuntunew/img/logo.png" />
              </a>
            </h1>
          </div>
          <noscript>
            <form action="http://www.google.com/cse" id="cse-search-box">
              <div>
                <input type="hidden" name="cx" value="004599128559784038176:vj_p0xo-nng" />
                <input type="hidden" name="ie" value="UTF-8" />
                <input type="text" name="q" size="27" />
                <input type="submit" name="sa" value="Search" />
              </div>
            </form>
          </noscript>
          <script>
 document.write('<form action="https://help.ubuntu.com/search.html" id="cse-search-box">');
 document.write('  <div>');
 document.write('    <input type="hidden" name="cof" value="FORID:9" />');
 document.write('    <input type="hidden" name="cx" value="004599128559784038176:vj_p0xo-nng" />');
 document.write('    <input type="hidden" name="ie" value="UTF-8" />');
 document.write('    <input type="text" name="q" size="27" />');
 document.write('    <input type="submit" name="sa" value="Search" />');
 document.write('  </div>');
 document.write('</form>');
</script>
          <div id="sitename">
            <a href="https://help.ubuntu.com/">
              <img alt="Official Documentation" src="https://help.ubuntu.com/htdocs/ubuntunew/img/help-about.png" />
              <span>Official Documentation</span>
            </a>
          </div>
        </div>
        <div id="page">
          <div id="content">
            <div class="breadcrumbs"><a href="https://help.ubuntu.com/">Ubuntu Documentation</a> &gt; <a href="https://help.ubuntu.com/10.04">Ubuntu 10.04</a> &gt; <span class="breadcrumb-link"><a href="index.html">Ubuntu Server Guide</a></span> &gt; <span class="breadcrumb-link"><a href="remote-administration.html">Remote Administration</a></span> &gt; <span class="breadcrumb-node">OpenSSH Server</span></div>
            <div xmlns="http://www.w3.org/1999/xhtml" class="sect1" title="OpenSSH Server">
              <div class="titlepage">
                <div>
                  <div>
                    <h2 class="title" style="clear: both"><a id="openssh-server"></a>OpenSSH Server</h2>
                  </div>
                </div>
              </div>
              <div class="sect2" title="Introduction">
                <div class="titlepage">
                  <div>
                    <div>
                      <h3 class="title"><a id="openssh-introduction"></a>Introduction</h3>
                    </div>
                  </div>
                </div>
                <p>
            This section of the Ubuntu Server Guide introduces a powerful collection of tools
            for the remote control of networked computers and transfer of data between 
	    networked computers, called <span class="emphasis"><em>OpenSSH</em></span>. You will also learn
            about some of the configuration settings possible with the OpenSSH server 
	    application and how to change them on your Ubuntu system. 
          </p>
                <p>
            OpenSSH is a freely available version of the Secure Shell (SSH) protocol family of 
            tools for remotely controlling a computer or transferring files between computers.
            Traditional tools used to accomplish these functions, such as 
	    <span class="application"><strong>telnet</strong></span> or <span class="application"><strong>rcp</strong></span>, are insecure 
	    and transmit the user's password in cleartext when used. OpenSSH provides a server 
	    daemon and client tools to facilitate secure, encrypted remote control and file 
	    transfer operations, effectively replacing the legacy tools.
          </p>
                <p>
            The OpenSSH server component, <span class="application"><strong>sshd</strong></span>, listens 
	    continuously for client connections from any of the client tools. When a connection 
	    request occurs, <span class="application"><strong>sshd</strong></span> sets up the correct connection 
	    depending on the type of client tool connecting. For example, if the remote 
	    computer is connecting with the <span class="application"><strong>ssh</strong></span> client application, 
	    the OpenSSH server sets up a remote control session after authentication. If a 
	    remote user connects to an OpenSSH server with <span class="application"><strong>scp</strong></span>, the 
	    OpenSSH server daemon initiates a secure copy of files between the server and 
	    client after authentication. OpenSSH can use many authentication methods, including             plain password, public key, and <span class="application"><strong>Kerberos</strong></span> tickets.
            </p>
              </div>
              <div class="sect2" title="Installation">
                <div class="titlepage">
                  <div>
                    <div>
                      <h3 class="title"><a id="openssh-installation"></a>Installation</h3>
                    </div>
                  </div>
                </div>
                <p>
        Installation of the OpenSSH client and server applications is simple. To install the 
	OpenSSH client applications on your Ubuntu system, use this command at a terminal 
	prompt:
        </p>
                <pre class="screen">
<span class="command"><strong>sudo apt-get install openssh-client</strong></span>
</pre>
                <p>
        To install the OpenSSH server application, and related support files, use this command 
	at a terminal prompt:
        </p>
                <pre class="screen">
<span class="command"><strong>sudo apt-get install openssh-server</strong></span>
</pre>
                <p>
	The <span class="application"><strong>openssh-server</strong></span> package can also be selected to 
	install during the Server Edition installation process.
	</p>
              </div>
              <div class="sect2" title="Configuration">
                <div class="titlepage">
                  <div>
                    <div>
                      <h3 class="title"><a id="openssh-configuration"></a>Configuration</h3>
                    </div>
                  </div>
                </div>
                <p>
          You may configure the default behavior of the OpenSSH server application, 
	  <span class="application"><strong>sshd</strong></span>, by editing the file 
	  <code class="filename">/etc/ssh/sshd_config</code>. For information about the configuration 
	  directives used in this file, you may view the appropriate manual page with the 
	  following command, issued at a terminal prompt:
          </p>
                <pre class="screen">
<span class="command"><strong>man sshd_config</strong></span>
</pre>
                <p>
            There are many directives in the <span class="application"><strong>sshd</strong></span> configuration 
	    file controlling such things as communication settings and authentication modes. 
	    The following are examples of configuration directives that can be changed by 
	    editing the <code class="filename">/etc/ssh/sshd_config</code> file.
            </p>
                <div class="tip" title="Tip" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <table border="0" summary="Tip">
                    <tr>
                      <td rowspan="2" align="center" valign="top" width="25">
                        <img alt="[Tip]" src="../../libs/admon/tip.png" />
                      </td>
                      <th align="left"></th>
                    </tr>
                    <tr>
                      <td align="left" valign="top">
                        <p>Prior to editing the configuration file, you should make a copy of the 
		original file and protect it from writing so you will have the original 
		settings as a reference and to reuse as necessary.
                </p>
                        <p>Copy the <code class="filename">/etc/ssh/sshd_config</code> file and protect it 
		from writing with the following commands, issued at a terminal prompt:
                </p>
                      </td>
                    </tr>
                  </table>
                </div>
                <pre class="screen">
<span class="command"><strong>sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.original</strong></span>
<span class="command"><strong>sudo chmod a-w /etc/ssh/sshd_config.original</strong></span>
</pre>
                <p>
            The following are examples of configuration directives you may change:
            </p>
                <div class="itemizedlist">
                  <ul class="itemizedlist" type="disc">
                    <li class="listitem">
                      <p>
               To set your OpenSSH to listen on TCP port 2222 instead of the default TCP port 
	       22, change the Port directive as such:
               </p>
                      <p>
               Port 2222
               </p>
                    </li>
                    <li class="listitem">
                      <p>
            To have <span class="application"><strong>sshd</strong></span> allow public key-based login credentials, 
	    simply add or modify the line:
            </p>
                      <p>
               PubkeyAuthentication yes
               </p>
                      <p>
            In the <code class="filename">/etc/ssh/sshd_config</code> file, or if already present, 
	    ensure the line is not commented out.
            </p>
                    </li>
                    <li class="listitem">
                      <p>
             To make your OpenSSH server display the contents of the 
	     <code class="filename">/etc/issue.net</code> file as a pre-login
             banner, simply add or modify the line:
             </p>
                      <p>
               Banner  /etc/issue.net
               </p>
                      <p>
               In the <code class="filename">/etc/ssh/sshd_config</code> file.
               </p>
                    </li>
                  </ul>
                </div>
                <p>
            After making changes to the <code class="filename">/etc/ssh/sshd_config</code> file, save 
	    the file, and restart the <span class="application"><strong>sshd</strong></span> server application to 
	    effect the changes using the following command at a terminal prompt:
            </p>
                <pre class="screen">
<span class="command"><strong>sudo /etc/init.d/ssh restart</strong></span>
</pre>
                <div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <table border="0" summary="Warning">
                    <tr>
                      <td rowspan="2" align="center" valign="top" width="25">
                        <img alt="[Warning]" src="../../libs/admon/warning.png" />
                      </td>
                      <th align="left"></th>
                    </tr>
                    <tr>
                      <td align="left" valign="top">
                        <p>
                  Many other configuration directives for <span class="application"><strong>sshd</strong></span> are 
	          available for changing the server application's behavior to fit your needs. 
		  Be advised, however, if your only method of access to a server is 
		  <span class="application"><strong>ssh</strong></span>, and you make a mistake in configuring 
		  <span class="application"><strong>sshd</strong></span> via the 
		  <code class="filename">/etc/ssh/sshd_config</code> file, you may find you
                  are locked out of the server upon restarting it, or that the 
		  <span class="application"><strong>sshd</strong></span> server refuses to start due to an incorrect 
		  configuration directive, so be extra careful when editing this file on a 
		  remote server.
                  </p>
                      </td>
                    </tr>
                  </table>
                </div>
              </div>
              <div class="sect2" title="SSH Keys">
                <div class="titlepage">
                  <div>
                    <div>
                      <h3 class="title"><a id="openssh-keys"></a>SSH Keys</h3>
                    </div>
                  </div>
                </div>
                <p>
     SSH <span class="emphasis"><em>keys</em></span> allow authentication between two hosts without the need of a password.  SSH key authentication 
     uses two keys a <span class="emphasis"><em>private</em></span> key and a <span class="emphasis"><em>public</em></span> key.
     </p>
                <p>
     To generate the keys, from a terminal prompt enter:
     </p>
                <pre class="screen">
<span class="command"><strong>ssh-keygen -t dsa</strong></span>
</pre>
                <p>
     This will generate the keys using a <span class="emphasis"><em>DSA</em></span> authentication identity of the user.  During the process you
     will be prompted for a password.  Simply hit <span class="emphasis"><em>Enter</em></span> when prompted to create the key.  
     </p>
                <p>
     By default the <span class="emphasis"><em>public</em></span> key is saved in the file <code class="filename">~/.ssh/id_dsa.pub</code>, while 
     <code class="filename">~/.ssh/id_dsa</code> is the <span class="emphasis"><em>private</em></span> key.  Now copy the <code class="filename">id_dsa.pub</code> file
     to the remote host and append it to <code class="filename">~/.ssh/authorized_keys</code> by entering:
     </p>
                <pre class="screen">
<span class="command"><strong>ssh-copy-id username@remotehost</strong></span>
</pre>
                <p>
     Finally, double check the permissions on the <code class="filename">authorized_keys</code> file, only the authenticated user should have read and write permissions.
     If the permissions are not correct change them by:
     </p>
                <pre class="screen">
<span class="command"><strong>chmod 600 .ssh/authorized_keys</strong></span>
</pre>
                <p>
     You should now be able to SSH to the host without being prompted for a password.
     </p>
              </div>
              <div class="sect2" title="References">
                <div class="titlepage">
                  <div>
                    <div>
                      <h3 class="title"><a id="openssh-references"></a>References</h3>
                    </div>
                  </div>
                </div>
                <div class="itemizedlist">
                  <ul class="itemizedlist" type="disc">
                    <li class="listitem">
                      <p>
          <a class="ulink" href="https://help.ubuntu.com/community/SSH" target="_top">Ubuntu Wiki SSH</a> page.
          </p>
                    </li>
                    <li class="listitem">
                      <p>
          <a class="ulink" href="http://www.openssh.org/" target="_top">OpenSSH Website</a>
          </p>
                    </li>
                    <li class="listitem">
                      <p>
          <a class="ulink" href="https://wiki.ubuntu.com/AdvancedOpenSSH" target="_top">Advanced OpenSSH Wiki Page</a>
          </p>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <div xmlns="http://www.w3.org/1999/xhtml" class="navfooter">
            <hr />
            <table width="100%" summary="Navigation footer">
              <tr>
                <td width="40%" align="left"><a accesskey="p" href="remote-administration.html"><img src="../../libs/navig/prev.png" alt="Prev" /></a> </td>
                <td width="20%" align="center">
                  <a accesskey="u" href="remote-administration.html">
                    <img src="../../libs/navig/up.png" alt="Up" />
                  </a>
                </td>
                <td width="40%" align="right"> <a accesskey="n" href="ebox.html"><img src="../../libs/navig/next.png" alt="Next" /></a></td>
              </tr>
              <tr>
                <td width="40%" align="left" valign="top">Chapter 5. Remote Administration </td>
                <td width="20%" align="center">
                  <a accesskey="h" href="index.html">
                    <img src="../../libs/navig/home.png" alt="Home" />
                  </a>
                </td>
                <td width="40%" align="right" valign="top"> eBox</td>
              </tr>
            </table>
          </div>
          <hr />
          <div id="footer">
            <div id="ubuntulinks">
              <p>The material in this document is available under a free license, see <a href="/legal.html">Legal</a> for details<br />
	For information on contributing see the <a href="https://wiki.ubuntu.com/DocumentationTeam">Ubuntu Documentation Team wiki page</a>. To report a problem, visit the <a href="https://bugs.launchpad.net/ubuntu/+source/ubuntu-docs">bug page for Ubuntu Documentation</a></p>
            </div>
          </div>
          <div id="bottomcap">
            <img src="https://help.ubuntu.com/htdocs/ubuntunew/img/cap-bottom.png" alt="" />
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
