<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head xmlns="http://www.w3.org/1999/xhtml">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title xmlns="">FTP Server</title>
    <link rel="stylesheet" href="../../libs/ubuntu-book.css" type="text/css" />
    <link rel="home" href="index.html" title="Ubuntu Server Guide" />
    <link rel="up" href="file-servers.html" title="Chapter 13. File Servers" />
    <link rel="prev" href="file-servers.html" title="Chapter 13. File Servers" />
    <link rel="next" href="network-file-system.html" title="Network File System (NFS)" />
    <link rel="copyright" href="legal.html" title="Credits and License" />
  </head>
  <body>
    <div id="round">
      <img id="topcap" alt="" src="https://help.ubuntu.com/htdocs/ubuntunew/img/cap-top.png" />
      <div id="layout" class="container clear-block">
        <script xmlns="" src="https://ssl.google-analytics.com/urchin.js" type="text/javascript"></script>
        <script xmlns="" type="text/javascript">
_uacct = "UA-1018242-8";
urchinTracker();
</script>
        <div id="header">
          <div id="logo-floater">
            <h1>
              <a href="https://help.ubuntu.com" title="Ubuntu Documentation">
                <img alt="Ubuntu" id="logo" src="https://help.ubuntu.com/htdocs/ubuntunew/img/logo.png" />
              </a>
            </h1>
          </div>
          <noscript>
            <form action="http://www.google.com/cse" id="cse-search-box">
              <div>
                <input type="hidden" name="cx" value="004599128559784038176:vj_p0xo-nng" />
                <input type="hidden" name="ie" value="UTF-8" />
                <input type="text" name="q" size="27" />
                <input type="submit" name="sa" value="Search" />
              </div>
            </form>
          </noscript>
          <script>
 document.write('<form action="https://help.ubuntu.com/search.html" id="cse-search-box">');
 document.write('  <div>');
 document.write('    <input type="hidden" name="cof" value="FORID:9" />');
 document.write('    <input type="hidden" name="cx" value="004599128559784038176:vj_p0xo-nng" />');
 document.write('    <input type="hidden" name="ie" value="UTF-8" />');
 document.write('    <input type="text" name="q" size="27" />');
 document.write('    <input type="submit" name="sa" value="Search" />');
 document.write('  </div>');
 document.write('</form>');
</script>
          <div id="sitename">
            <a href="https://help.ubuntu.com/">
              <img alt="Official Documentation" src="https://help.ubuntu.com/htdocs/ubuntunew/img/help-about.png" />
              <span>Official Documentation</span>
            </a>
          </div>
        </div>
        <div id="page">
          <div id="content">
            <div class="breadcrumbs"><a href="https://help.ubuntu.com/">Ubuntu Documentation</a> &gt; <a href="https://help.ubuntu.com/10.04">Ubuntu 10.04</a> &gt; <span class="breadcrumb-link"><a href="index.html">Ubuntu Server Guide</a></span> &gt; <span class="breadcrumb-link"><a href="file-servers.html">File Servers</a></span> &gt; <span class="breadcrumb-node">FTP Server</span></div>
            <div xmlns="http://www.w3.org/1999/xhtml" class="sect1" title="FTP Server">
              <div class="titlepage">
                <div>
                  <div>
                    <h2 class="title" style="clear: both"><a id="ftp-server"></a>FTP Server</h2>
                  </div>
                </div>
              </div>
              <p>
          File Transfer Protocol (FTP) is a TCP protocol for uploading and downloading
          files between computers. FTP works on a client/server model. The server component is
          called an <span class="emphasis"><em>FTP daemon</em></span>. It continuously listens for FTP requests
          from remote clients. When a request is received, it manages the login and sets up
          the connection. For the duration of the session it executes any of commands sent by
          the FTP client.
          </p>
              <p>Access to an FTP server can be managed in two ways:</p>
              <div class="itemizedlist">
                <ul class="itemizedlist" type="disc" compact="compact">
                  <li class="listitem">
                    <p>Anonymous</p>
                  </li>
                  <li class="listitem">
                    <p>Authenticated</p>
                  </li>
                </ul>
              </div>
              <p>
          In the Anonymous mode, remote clients can access the FTP server by using the
          default user account called "anonymous" or "ftp" and
          sending an email address as the password. In the Authenticated mode a user must
          have an account and a password. User access to the FTP server directories and files is
          dependent on the permissions defined for the account used at login. As a general
          rule, the FTP daemon will hide the root directory of the FTP server and change it to
          the FTP Home directory. This hides the rest of the file system from remote
          sessions.
          </p>
              <div class="sect2" title="vsftpd - FTP Server Installation">
                <div class="titlepage">
                  <div>
                    <div>
                      <h3 class="title"><a id="vsftpd-ftp-server-installation"></a>vsftpd - FTP Server Installation</h3>
                    </div>
                  </div>
                </div>
                <p>
            vsftpd is an FTP daemon available in
            Ubuntu. It is easy to install, set up, and
            maintain.  To install <span class="application"><strong>vsftpd</strong></span> you
            can run the following command:
            </p>
                <pre class="screen">
<span class="command"><strong>sudo apt-get install vsftpd</strong></span>
</pre>
              </div>
              <div class="sect2" title="Anonymous FTP Configuration">
                <div class="titlepage">
                  <div>
                    <div>
                      <h3 class="title"><a id="vsftpd-anonymous-configuration"></a>Anonymous FTP Configuration</h3>
                    </div>
                  </div>
                </div>
                <p>
                By default <span class="application"><strong>vsftpd</strong></span> is configured 
                to only allow anonymous download.  During installation a 
                <span class="emphasis"><em>ftp</em></span> user is created with a home directory 
                of <code class="filename">/home/ftp</code>.  This is the default FTP directory.
                </p>
                <p>
                If you wish to change this location, to <code class="filename">/srv/ftp</code>
                for example, simply create a directory in another location and 
                change the <span class="emphasis"><em>ftp</em></span> user's home directory:
                </p>
                <pre class="screen">
<span class="command"><strong>sudo mkdir /srv/ftp</strong></span>
<span class="command"><strong>sudo usermod -d /srv/ftp ftp</strong></span> 
</pre>
                <p>
                After making the change restart <span class="application"><strong>vsftpd</strong></span>:
                </p>
                <pre class="screen">
<span class="command"><strong>sudo /etc/init.d/vsftpd restart</strong></span>
</pre>
                <p>
                Finally, copy any files and directories you would like to make available
                through anonymous FTP to <code class="filename">/srv/ftp</code>.
                </p>
              </div>
              <div class="sect2" title="User Authenticated FTP Configuration">
                <div class="titlepage">
                  <div>
                    <div>
                      <h3 class="title"><a id="vsftpd-userauth-configuration"></a>User Authenticated FTP Configuration</h3>
                    </div>
                  </div>
                </div>
                <p>
                To configure <span class="application"><strong>vsftpd</strong></span> to authenticate
                system users and allow them to upload files edit
                <code class="filename">/etc/vsftpd.conf</code>:
                </p>
                <pre class="programlisting">
local_enable=YES
write_enable=YES
</pre>
                <p>
                Now restart <span class="application"><strong>vsftpd</strong></span>:
                </p>
                <pre class="screen">
<span class="command"><strong>sudo /etc/init.d/vsftpd restart</strong></span>
</pre>
                <p>
                Now when system users login to FTP they will start in their 
                <span class="emphasis"><em>home</em></span> directories where they can download,
                upload, create directories, etc.
                </p>
                <p>
                Similarly, by default, the anonymous users are not
                allowed to upload files to FTP server. To change
                this setting, you should uncomment the following
                line, and restart <span class="application"><strong>vsftpd</strong></span>:
                </p>
                <pre class="programlisting">
anon_upload_enable=YES
</pre>
                <div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <table border="0" summary="Warning">
                    <tr>
                      <td rowspan="2" align="center" valign="top" width="25">
                        <img alt="[Warning]" src="../../libs/admon/warning.png" />
                      </td>
                      <th align="left"></th>
                    </tr>
                    <tr>
                      <td align="left" valign="top">
                        <p>
                  Enabling anonymous FTP upload can be an extreme security risk.  It is best to not enable 
                  anonymous upload on servers accessed directly from the Internet.
                  </p>
                      </td>
                    </tr>
                  </table>
                </div>
                <p>
                The configuration file consists of many
                configuration parameters. The information about
                each parameter is available in the configuration
                file. Alternatively, you can refer to the man
                page, <span class="command"><strong>man 5 vsftpd.conf</strong></span> for
                details of each parameter. 
                </p>
              </div>
              <div class="sect2" title="Securing FTP">
                <div class="titlepage">
                  <div>
                    <div>
                      <h3 class="title"><a id="vsftpd-security"></a>Securing FTP</h3>
                    </div>
                  </div>
                </div>
                <p> 
                  There are options in <code class="filename">/etc/vsftpd.conf</code> to
                  help make <span class="application"><strong>vsftpd</strong></span> more secure.  For
                  example users can be limited to their home directories by uncommenting:
                  </p>
                <pre class="programlisting">
chroot_local_user=YES
</pre>
                <p>
                  You can also limit a specific list of users to just their home directories:
                  </p>
                <pre class="programlisting">
chroot_list_enable=YES
chroot_list_file=/etc/vsftpd.chroot_list
</pre>
                <p>
                  After uncommenting the above options, create a <code class="filename">/etc/vsftpd.chroot_list</code>
                  containing a list of users one per line.  Then restart <span class="application"><strong>vsftpd</strong></span>:
                  </p>
                <pre class="screen">
<span class="command"><strong>sudo /etc/init.d/vsftpd restart</strong></span>
</pre>
                <p>
                  Also, the <code class="filename">/etc/ftpusers</code> file is a list of users that
                  are <span class="emphasis"><em>disallowed</em></span> FTP access.  The default list 
                  includes root, daemon, nobody, etc.  To disable FTP access for additional
                  users simply add them to the list.
                  </p>
                <p>
                  FTP can also be encrypted using <span class="emphasis"><em>FTPS</em></span>.  Different from <span class="emphasis"><em>SFTP</em></span>,
                  <span class="emphasis"><em>FTPS</em></span> is FTP over Secure Socket Layer (SSL).  <span class="emphasis"><em>SFTP</em></span> is a FTP 
                  like session over an encrypted <span class="emphasis"><em>SSH</em></span> connection.  A major difference is that users
                  of SFTP need to have a <span class="emphasis"><em>shell</em></span> account on the system, instead of a 
                  <span class="emphasis"><em>nologin</em></span> shell.  Providing all users with a shell may not be ideal for some 
                  environments, such as a shared web host.
                  </p>
                <p>
                  To configure <span class="emphasis"><em>FTPS</em></span>, edit <code class="filename">/etc/vsftpd.conf</code> and at the bottom add:
                  </p>
                <pre class="programlisting">
ssl_enable=Yes
</pre>
                <p>
                  Also, notice the certificate and key related options:
                  </p>
                <pre class="programlisting">
rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem
rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key
</pre>
                <p>
                  By default these options are set the certificate and key provided by the <span class="application"><strong>ssl-cert</strong></span>
                  package.  In a production environment these should be replaced with a certificate and key generated for the specific
                  host.  For more information on certificates see <a class="xref" href="certificates-and-security.html" title="Certificates">the section called “Certificates”</a>.
                  </p>
                <p>
                  Now restart <span class="application"><strong>vsftpd</strong></span>, and non-anonymous users will be forced to use 
                  <span class="emphasis"><em>FTPS</em></span>:
                  </p>
                <pre class="screen">
<span class="command"><strong>sudo /etc/init.d/vsftpd restart</strong></span>
</pre>
                <p>
                  To allow users with a shell of <code class="filename">/usr/sbin/nologin</code> access to FTP, but have no shell access, 
                  edit <code class="filename">/etc/shells</code> adding the <span class="emphasis"><em>nologin</em></span> shell:
                  </p>
                <pre class="programlisting">
# /etc/shells: valid login shells
/bin/csh
/bin/sh
/usr/bin/es
/usr/bin/ksh
/bin/ksh
/usr/bin/rc
/usr/bin/tcsh
/bin/tcsh
/usr/bin/esh
/bin/dash
/bin/bash
/bin/rbash
/usr/bin/screen
/usr/sbin/nologin
</pre>
                <p>
                  This is necessary because, by default <span class="application"><strong>vsftpd</strong></span> uses PAM for authentication, and the 
                  <code class="filename">/etc/pam.d/vsftpd</code> configuration file contains:
                  </p>
                <pre class="programlisting">
auth    required        pam_shells.so
</pre>
                <p>
                  The <span class="emphasis"><em>shells</em></span> PAM module restricts access to shells listed in the <code class="filename">/etc/shells</code>
                  file.
                  </p>
                <p>
                  Most popular FTP clients can be configured connect using FTPS.  The <span class="application"><strong>lftp</strong></span> command line FTP
                  client has the ability to use FTPS as well.
                  </p>
              </div>
              <div class="sect2" title="References">
                <div class="titlepage">
                  <div>
                    <div>
                      <h3 class="title"><a id="vsftpd-references"></a>References</h3>
                    </div>
                  </div>
                </div>
                <div class="itemizedlist">
                  <ul class="itemizedlist" type="disc">
                    <li class="listitem">
                      <p>
                      See the <a class="ulink" href="http://vsftpd.beasts.org/vsftpd_conf.html" target="_top">vsftpd website</a> for more information.
                      </p>
                    </li>
                    <li class="listitem">
                      <p>
                      For detailed <code class="filename">/etc/vsftpd.conf</code> options see the 
                      <a class="ulink" href="http://manpages.ubuntu.com/manpages/lucid/en/man5/vsftpd.conf.5.html" target="_top">vsftpd.conf man page</a>.
                      </p>
                    </li>
                    <li class="listitem">
                      <p>
                      The CodeGurus article <a class="ulink" href="http://www.codeguru.com/csharp/.net/net_general/internet/article.php/c14329" target="_top">
                      FTPS vs. SFTP: What to Choose</a> has useful information contrasting FTPS and SFTP.
                      </p>
                    </li>
                    <li class="listitem">
                      <p>
                      Also, for more information see the <a class="ulink" href="https://help.ubuntu.com/community/vsftpd" target="_top">Ubuntu Wiki vsftpd</a> page.
                      </p>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <div xmlns="http://www.w3.org/1999/xhtml" class="navfooter">
            <hr />
            <table width="100%" summary="Navigation footer">
              <tr>
                <td width="40%" align="left"><a accesskey="p" href="file-servers.html"><img src="../../libs/navig/prev.png" alt="Prev" /></a> </td>
                <td width="20%" align="center">
                  <a accesskey="u" href="file-servers.html">
                    <img src="../../libs/navig/up.png" alt="Up" />
                  </a>
                </td>
                <td width="40%" align="right"> <a accesskey="n" href="network-file-system.html"><img src="../../libs/navig/next.png" alt="Next" /></a></td>
              </tr>
              <tr>
                <td width="40%" align="left" valign="top">Chapter 13. File Servers </td>
                <td width="20%" align="center">
                  <a accesskey="h" href="index.html">
                    <img src="../../libs/navig/home.png" alt="Home" />
                  </a>
                </td>
                <td width="40%" align="right" valign="top"> Network File System (NFS)</td>
              </tr>
            </table>
          </div>
          <hr />
          <div id="footer">
            <div id="ubuntulinks">
              <p>The material in this document is available under a free license, see <a href="/legal.html">Legal</a> for details<br />
	For information on contributing see the <a href="https://wiki.ubuntu.com/DocumentationTeam">Ubuntu Documentation Team wiki page</a>. To report a problem, visit the <a href="https://bugs.launchpad.net/ubuntu/+source/ubuntu-docs">bug page for Ubuntu Documentation</a></p>
            </div>
          </div>
          <div id="bottomcap">
            <img src="https://help.ubuntu.com/htdocs/ubuntunew/img/cap-bottom.png" alt="" />
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
